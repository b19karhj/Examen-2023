<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body onload="compareText();">
    <!-- Password box for google guidline passwords-->
    <div>
        <label for="noMSA">Password 1</label>
        <input type="text" id="noMSA" name="noMSA">
        <input type="submit" value="submit1">
    </div>
     <!-- Password box for MSA passwords-->
    <div>
        <label for="MSA">Password 2</label>
        <input type="text" id="MSA" name="MSA">
        <input type="submit" value="submit2" onclick="MSA();">
    </div>
    <script>
         var words; //Global veriabel som håller innehåller alla ord från ordlistan.

         /*compareText gör det enkelt att ändra textfil eller uppdatera den. Nackdelen är att den behöver laddas in på användarens
         webrowser vid besök*/
         function compareText(){  //Skriv kommentarer imorgon.
            fetch("wordList.txt") //Hämtar textfilen.
                .then(function(textFile){ //En promise some tar emot datan och en response.
                    return (textFile.text()); //Splitar innehållet på "\n".
            })
            .then(function(data){  //Tar emot datan från returnen.
                words = data.split("\r\n"); //Splittar textfilen och sparar i strängen.
            })
        }

        //Algorithm for MSA
        function MSA(){
            //Varibales
            var password; //Holds passwords from password 2
            var temp; //Stores the password created while last character is deleted.
            var wordDetector = 0;
            var savedWords = [];
            var segmentationTracker = []; //Keeps track of all segmentations
            var MSACheck = true;
            var segmentedPassword = [];
            password = document.getElementById("MSA").value;
            //console.log(password)
        
           
            while(MSACheck == true){

            const alphabet = /^[a-zA-Z]/ //Regex if first char is lower and uppercase charecter
            const alphabet2 = (/[a-z]/);
            const number = /^[0-9]/; //Regex Numbers
            const numbers = (/[0-9]/);
            const notNumber = /^\D/;
            const lastCharNr = (/|0-9]$/);
            const lastCharAP = (/[a-zA-Z]$/);
            const specialCharacter = /^\W/; //Regex special characters
                /*if(password.match(number) || password.match(specialCharacter)){ //Checks if first element is number or special character
                    alert("password")
                }*/

                while(password.match(number)){ //Checks if password starts with number, if so then put the number into array
                    segmentationTracker.push(password.match(number));
                    password = password.substring(1);
                    
                }
                while(password.match(specialCharacter)){ //Checks if password starts with special character, if so then put the character into into array
                    segmentationTracker.push(password.match(specialCharacter))
                    password = password.substring(1);
                    //console.log(password)
                }
                
                //}
                
                /*TODO:
                Skapa en alternativ substräng där special karaktärer vandlas om till bokstäver. Om träff spara undan dom som orginal strängen.
                Efter det fråga mot databasen.
                Efter det formulera tydliga riktlinjer
                Efter det skapa formulär
                Samla in data*/

                for (let i = 0; i < password.length; i++){
                    temp = password.substring(0, password.length - i); //Deletes last character after each iteration
                    console.log(password.substring(0));
                    if(words.includes(temp)){

                        console.log("word found");
                        //console.log(temp);
                        wordDetector++;
                        segmentationTracker.push(temp); //Adds the word to segmentation tracker
                        password = password.replace(`${temp}`, ""); //Replaces the word in password string with nothing.

                    }
                    else if(temp.length <= 1){ //If temp.length is less then 1 in length, enter here to remove characters.
                        //alert("hej");
                        //console.log(temp, "inne");
                        segmentationTracker.push(temp[0]);
                        //console.log(segmentationTracker)
                        password = password.substring(1);
                        //alert(password.length)
                        
                        i == 0; //Resets "i" to loop over the new password.
                       
                        
                    }
                    
                   // console.log(temp[0])
                };
                //console.log(temp.length)
                //console.log(temp)
                //console.log(password ,"empty");
                //console.log(segmentationTracker)
                //console.log(password.length)
                
                if(password.length == 0){
                    var tempholder;
                    var segments;
                    var passhold;
                    segments = segmentationTracker.toString().split(/,/g);

                    if(segmentedPassword.length == 0){
                        segmentedPassword = segmentedPassword.concat(segments[0]);
                        console.log(segmentedPassword, "saved");
                        segments = segments.slice(1);
                        console.log(segments, "segments")
                    }
                    
                 
                   
                    for(let i = 0; segments.length > 0; i++){
                        console.log(segmentedPassword[i], "is")
                        if(segmentedPassword[i] == ","){
                            i++;
                        }
                        console.log(segments[0], "seg")
                        console.log(segments[0].length)

                        /*if(segments[i-1].match(numbers) && segments[i].match(numbers) && segmentedPassword == 0 || segments[i-1].match(specialCharacter) && segments[i].match(specialCharacter) && segmentedPassword == 0 || segments[i-1].match(alphabet) && segments[i-1].length <= 1 && segments[i].match(alphabet) && segments[i].length <= 1 && segmentedPassword == 0){   //Checks if the first 2 elements are both numbers, characters or special characters
                            
                            if(segmentedPassword == 0){
                                alert("Två element i början är lika");
                                tempholder = segments[i-1].concat(segments[i]);
                                segmentedPassword.push(tempholder);
                                segments = segments.slice(2);
                                segmentationTracker = segmentationTracker.slice(2);
                              
                                console.log(segments, "saved");

                                tempholder = "";
                                i = 0;
                                console.log(segmentedPassword[i], "is");
                              
                                alert("pause")
                                if(segments.length == 0){
                                    alert("zero");
                                    MSACheck = false;
                                }
                            
                              
                            }
                            /*else{
                                console.log(segmentationTracker)
                                alert("Två element senare var lika");
                                console.log(i, "i value")
                                tempholder += segments[i-1].concat(segments[i]);
                                console.log(tempholder, "tempholder")
                                segmentedPassword.push(tempholder);
                                segments = segments.slice(2);
                                segmentationTracker = segmentationTracker.slice(2);
                                console.log(segmentedPassword, "saved")
                                console.log(segments, "segments");
                                console.log(segmentationTracker, "left in loop")
                                tempholder = "";
                                i = 0;
                                alert("pause")
                                if(segments.length == 0){
                                    alert("zero");
                                    console.log(segmentedPassword, "finished")
                                    MSACheck = false;
                                }
                            };
                            
                        }*/
                        if(segmentedPassword[i].match(numbers) && segments[0].match(numbers) || segmentedPassword[i].match(specialCharacter) && segments[0].match(specialCharacter) || segmentedPassword[i].match(alphabet) && segments[0].match(alphabet2) && segments[0].length <= 1){
                            alert("Number")
                            tempholder = segmentedPassword.concat(segments[0]);
                           // console.log(tempholder , "hold");
                            //console.log(tempholder.length);
                            if(tempholder.length <= 2){
                                alert("inne igen")
                                tempholder = tempholder.join("");
                            }
                            console.log(tempholder , "hold");
                            segmentedPassword = tempholder;
                            console.log(segmentedPassword , "segholder");
                            segments = segments.slice(1);
                            console.log(segments, "after slice");
                            console.log(segments.length, "seg length");
                          
                            alert("itteration klar");
                            
                            
                        }else{
                            segmentedPassword = segmentedPassword.concat(","+segments[0]);
                            segments = segments.slice(1);
                            console.log(segments, "after slice");
                            console.log(segmentedPassword , "segholder");
                            console.log(segments.length, "seg length");
                            
                        }
                        
                        if(segments.length == 0){
                            alert("slut")
                            MSACheck = false;
                        }
                            
                       
                    };
                    
                    
                }
              
        }  
        console.log("The segmentedPassword is: ", segmentedPassword)
        console.log("password is no more", password)
        
    }
    </script>
</body>
</html>
